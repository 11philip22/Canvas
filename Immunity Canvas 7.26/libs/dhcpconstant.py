#!/usr/bin/env python

from MOSDEF.mosdefutils import *

import string

MagicCookie = "\x63\x82\x53\x63"

def NoneFunc(data):
    pass
        
# phil is gonna be proud of me:
DhcpSizeDecode = {0: NoneFunc, 1: ord, 2: str2int16_swapped, 4: str2littleendian} 
DhcpSizeEncode = {0: NoneFunc, 1: chr, 2: int2str16_swapped, 4: int2str32_swapped} 

# DHCP options taken from: 
#   http://www.iana.org/assignments/bootp-dhcp-parameters
DhcpOptions = {}
DhcpOptions[0]= (0,'pad','None')
DhcpOptions[1]= (4,'subnet mask','Subnet Mask Value')
DhcpOptions[2]= (4,'time offset','Time Offset in')
DhcpOptions[3]= (4,'router','N/4 Router addresses')
DhcpOptions[4]= (-1,'time server','N/4 Timeserver addresses')
DhcpOptions[5]= (-1,'name server','N/4 IEN-116 Server addresses')
DhcpOptions[6]= (-1,'domain server','N/4 DNS Server addresses')
DhcpOptions[7]= (-1,'log server','N/4 Logging Server addresses')
DhcpOptions[8]= (-1,'quotes server','N/4 Quotes Server addresses')
DhcpOptions[9]= (-1,'lpr server','N/4 Printer Server addresses')
DhcpOptions[10]= (-1,'impress server','N/4 Impress Server addresses')
DhcpOptions[11]= (-1,'rlp server','N/4 RLP Server addresses')
DhcpOptions[12]= (-1,'hostname','Hostname string')
DhcpOptions[13]= (2,'boot file size','Size of boot file in 512 byte')
DhcpOptions[14]= (-1,'merit dump file','Client to dump and name')
DhcpOptions[15]= (-1,'domain name','The DNS domain name of the')
DhcpOptions[16]= (-1,'swap server','Swap Server addeess')
DhcpOptions[17]= (-1,'root path','Path name for root disk')
DhcpOptions[18]= (-1,'extension file','Path name for more BOOTP info')
DhcpOptions[19]= (1,'forward on/off','Enable/Disable IP Forwarding')
DhcpOptions[20]= (1,'srcrte on/off','Enable/Disable Source Routing')
DhcpOptions[21]= (-1,'policy filter','Routing Policy Filters')
DhcpOptions[22]= (2,'max dg assembly','Max Datagram Reassembly Size')
DhcpOptions[23]= (1,'default ip ttl','Default IP Time to Live')
DhcpOptions[24]= (4,'mtu timeout','Path MTU Aging Timeout')
DhcpOptions[25]= (-1,'mtu plateau','Path MTU  Plateau Table')
DhcpOptions[26]= (2,'mtu interface','Interface MTU Size')
DhcpOptions[27]= (1,'mtu subnet','All Subnets are Local')
DhcpOptions[28]= (4,'broadcast address','Broadcast Address')
DhcpOptions[29]= (1,'mask discovery','Perform Mask Discovery')
DhcpOptions[30]= (1,'mask supplier','Provide Mask to Others')
DhcpOptions[31]= (1,'router discovery','Perform Router Discovery')
DhcpOptions[32]= (4,'router request','Router Solicitation Address')
DhcpOptions[33]= (-1,'static route','Static Routing Table')
DhcpOptions[34]= (1,'trailers','Trailer Encapsulation')
DhcpOptions[35]= (4,'arp timeout','ARP Cache Timeout')
DhcpOptions[36]= (1,'ethernet','Ethernet Encapsulation')
DhcpOptions[37]= (1,'default tcp ttl','Default TCP Time to Live')
DhcpOptions[38]= (4,'keepalive time','TCP Keepalive Interval')
DhcpOptions[39]= (1,'keepalive data','TCP Keepalive Garbage')
DhcpOptions[40]= (-1,'nis domain','NIS Domain Name')
DhcpOptions[41]= (-1,'nis servers','NIS Server Addresses')
DhcpOptions[42]= (-1,'ntp servers','NTP Server Addresses')
DhcpOptions[43]= (-1,'vendor specific','Vendor Specific Information')
DhcpOptions[44]= (-1,'netbios name srv','NETBIOS Name Servers')
DhcpOptions[45]= (-1,'netbios dist srv','NETBIOS Datagram Distribution')
DhcpOptions[46]= (1,'netbios node type','NETBIOS Node Type')
DhcpOptions[47]= (-1,'netbios scope','NETBIOS Scope')
DhcpOptions[48]= (-1,'x window font','X Window Font Server')
DhcpOptions[49]= (-1,'x window manager','X Window Display Manager')
DhcpOptions[50]= (4,'address request','Requested IP Address')
DhcpOptions[51]= (4,'address time','IP Address Lease Time')
DhcpOptions[52]= (1,'overload','Overload "sname" or "file"')
DhcpOptions[53]= (1,'dhcp msg type','DHCP Message Type')
DhcpOptions[54]= (4,'dhcp server id','DHCP Server Identification')
DhcpOptions[55]= (-1,'parameter list','Parameter Request List')
DhcpOptions[56]= (-1,'dhcp message','DHCP Error Message')
DhcpOptions[57]= (2,'dhcp max msg size','DHCP Maximum Message Size')
DhcpOptions[58]= (4,'renewal time','DHCP Renewal (T1) Time')
DhcpOptions[59]= (4,'rebinding time','DHCP Rebinding (T2) Time')
DhcpOptions[60]= (-1,'class id','Class Identifier')
DhcpOptions[61]= (-1,'client id','Client Identifier')
DhcpOptions[62]= (-1,'netware/ip domain','Netware/IP Domain Name')
DhcpOptions[63]= (-1,'netware/ip option','Netware/IP sub Options')
DhcpOptions[64]= (-1,'nis-domain-name','NIS+ v3 Client Domain Name')
DhcpOptions[65]= (-1,'nis-server-addr','NIS+ v3 Server Addresses')
DhcpOptions[66]= (-1,'server-name','TFTP Server Name')
DhcpOptions[67]= (-1,'bootfile-name','Boot File Name')
DhcpOptions[68]= (-1,'home-agent-addrs','Home Agent Addresses')
DhcpOptions[69]= (-1,'smtp-server','Simple Mail Server Addresses')
DhcpOptions[70]= (-1,'pop3-server','Post Office Server Addresses')
DhcpOptions[71]= (-1,'nntp-server','Network News Server Addresses')
DhcpOptions[72]= (-1,'www-server','WWW Server Addresses')
DhcpOptions[73]= (-1,'finger-server','Finger Server Addresses')
DhcpOptions[74]= (-1,'irc-server','Chat Server Addresses')
DhcpOptions[75]= (-1,'streettalk-server','StreetTalk Server Addresses')
DhcpOptions[76]= (-1,'stda-server','ST Directory Assist. Addresses')
DhcpOptions[77]= (-1,'user-class','User Class Information')
DhcpOptions[78]= (-1,'directory agent','directory agent information')
DhcpOptions[79]= (-1,'service scope','service location agent scope')
DhcpOptions[80]= (0,'rapid commit','Rapid Commit')
DhcpOptions[81]= (-1,'client fqdn','Fully Qualified Domain Name')
DhcpOptions[82]= (-1,'relay agent information','Relay Agent Information')
DhcpOptions[83]= (-1,'isns','Internet Storage Name Service')
DhcpOptions[85]= (-1,'nds servers','Novell Directory Services')
DhcpOptions[86]= (-1,'nds tree name','Novell Directory Services')
DhcpOptions[87]= (-1,'nds context','Novell Directory Services')
DhcpOptions[90]= (-1,'authentication','Authentication')
DhcpOptions[93]= (-1,'client system','Client System Architecture')
DhcpOptions[94]= (-1,'client ndi','Client Network Device Interface')
DhcpOptions[95]= (-1,'ldap','Lightweight Directory Access Protocol')
DhcpOptions[97]= (-1,'uuid/guid','UUID/GUID-based Client Identifier')
DhcpOptions[98]= (-1,'user-auth','Open Groups User Authentication')
DhcpOptions[112]= (-1,'netinfo address','NetInfo Parent Server Address')
DhcpOptions[113]= (-1,'netinfo tag','NetInfo Parent Server Tag')
DhcpOptions[114]= (-1,'url','URL')
DhcpOptions[116]= (-1,'auto-config','DHCP Auto-Configuration')
DhcpOptions[117]= (-1,'name service search','Name Service Search')
DhcpOptions[118]= (4,'subnet selection option','Subnet Selection Option')
DhcpOptions[119]= (-1,'domain search','DNS domain serach list')
DhcpOptions[120]= (-1,'sip servers dhcp option','SIP Servers DHCP Option')
DhcpOptions[121]= (-1,'classless static route','Classless Static Route Option')
DhcpOptions[122]= (-1,'ccc','CableLabs Client Configuration')
DhcpOptions[123]= (16,'geoconf option','GeoConf Option')
DhcpOptions[250]= (-1,'append','Append')
DhcpOptions[255]= (0,'end','None')

DhcpOptionsbyName = {}
DhcpOptionsbyName['pad']=0
DhcpOptionsbyName['subnet mask']=1
DhcpOptionsbyName['time offset']=2
DhcpOptionsbyName['router']=3
DhcpOptionsbyName['time server']=4
DhcpOptionsbyName['name server']=5
DhcpOptionsbyName['domain server']=6
DhcpOptionsbyName['log server']=7
DhcpOptionsbyName['quotes server']=8
DhcpOptionsbyName['lpr server']=9
DhcpOptionsbyName['impress server']=10
DhcpOptionsbyName['rlp server']=11
DhcpOptionsbyName['hostname']=12
DhcpOptionsbyName['boot file size']=13
DhcpOptionsbyName['merit dump file']=14
DhcpOptionsbyName['domain name']=15
DhcpOptionsbyName['swap server']=16
DhcpOptionsbyName['root path']=17
DhcpOptionsbyName['extension file']=18
DhcpOptionsbyName['forward on/off']=19
DhcpOptionsbyName['srcrte on/off']=20
DhcpOptionsbyName['policy filter']=21
DhcpOptionsbyName['max dg assembly']=22
DhcpOptionsbyName['default ip ttl']=23
DhcpOptionsbyName['mtu timeout']=24
DhcpOptionsbyName['mtu plateau']=25
DhcpOptionsbyName['mtu interface']=26
DhcpOptionsbyName['mtu subnet']=27
DhcpOptionsbyName['broadcast address']=28
DhcpOptionsbyName['mask discovery']=29
DhcpOptionsbyName['mask supplier']=30
DhcpOptionsbyName['router discovery']=31
DhcpOptionsbyName['router request']=32
DhcpOptionsbyName['static route']=33
DhcpOptionsbyName['trailers']=34
DhcpOptionsbyName['arp timeout']=35
DhcpOptionsbyName['ethernet']=36
DhcpOptionsbyName['default tcp ttl']=37
DhcpOptionsbyName['keepalive time']=38
DhcpOptionsbyName['keepalive data']=39
DhcpOptionsbyName['nis domain']=40
DhcpOptionsbyName['nis servers']=41
DhcpOptionsbyName['ntp servers']=42
DhcpOptionsbyName['vendor specific']=43
DhcpOptionsbyName['netbios name srv']=44
DhcpOptionsbyName['netbios dist srv']=45
DhcpOptionsbyName['netbios node type']=46
DhcpOptionsbyName['netbios scope']=47
DhcpOptionsbyName['x window font']=48
DhcpOptionsbyName['x window manager']=49
DhcpOptionsbyName['address request']=50
DhcpOptionsbyName['address time']=51
DhcpOptionsbyName['overload']=52
DhcpOptionsbyName['dhcp msg type']=53
DhcpOptionsbyName['dhcp server id']=54
DhcpOptionsbyName['parameter list']=55
DhcpOptionsbyName['dhcp message']=56
DhcpOptionsbyName['dhcp max msg size']=57
DhcpOptionsbyName['renewal time']=58
DhcpOptionsbyName['rebinding time']=59
DhcpOptionsbyName['class id']=60
DhcpOptionsbyName['client id']=61
DhcpOptionsbyName['netware/ip domain']=62
DhcpOptionsbyName['netware/ip option']=63
DhcpOptionsbyName['nis-domain-name']=64
DhcpOptionsbyName['nis-server-addr']=65
DhcpOptionsbyName['server-name']=66
DhcpOptionsbyName['bootfile-name']=67
DhcpOptionsbyName['home-agent-addrs']=68
DhcpOptionsbyName['smtp-server']=69
DhcpOptionsbyName['pop3-server']=70
DhcpOptionsbyName['nntp-server']=71
DhcpOptionsbyName['www-server']=72
DhcpOptionsbyName['finger-server']=73
DhcpOptionsbyName['irc-server']=74
DhcpOptionsbyName['streettalk-server']=75
DhcpOptionsbyName['stda-server']=76
DhcpOptionsbyName['user-class']=77
DhcpOptionsbyName['directory agent']=78
DhcpOptionsbyName['service scope']=79
DhcpOptionsbyName['rapid commit']=80
DhcpOptionsbyName['client fqdn']=81
DhcpOptionsbyName['relay agent information']=82
DhcpOptionsbyName['isns']=83
DhcpOptionsbyName['nds servers']=85
DhcpOptionsbyName['nds tree name']=86
DhcpOptionsbyName['nds context']=87
DhcpOptionsbyName['authentication']=90
DhcpOptionsbyName['client system']=93
DhcpOptionsbyName['client ndi']=94
DhcpOptionsbyName['ldap']=95
DhcpOptionsbyName['uuid/guid']=97
DhcpOptionsbyName['user-auth']=98
DhcpOptionsbyName['netinfo address']=112
DhcpOptionsbyName['netinfo tag']=113
DhcpOptionsbyName['url']=114
DhcpOptionsbyName['auto-config']=116
DhcpOptionsbyName['name service search']=117
DhcpOptionsbyName['subnet selection option']=118
DhcpOptionsbyName['domain search']=119
DhcpOptionsbyName['sip servers dhcp option']=120
DhcpOptionsbyName['classless static route']=121
DhcpOptionsbyName['ccc']=122
DhcpOptionsbyName['geoconf option']=123
DhcpOptionsbyName['append']=250
DhcpOptionsbyName['end']=255
