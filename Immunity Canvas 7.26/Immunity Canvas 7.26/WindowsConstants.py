#globals for win32
O_RDONLY = 0x0
O_RDWR= 0x2
O_CREAT=0x40
O_TRUNC=0x200
AF_INET=2
SOCK_STREAM=1
SOCK_DGRAM=2

MODE_ALL=0x1ff #777 (read,write,execute all,all,all)
#end globals

DUPLICATE_SAME_ACCESS=0x00000002
OF_READ=0
OF_READWRITE=2
OF_WRITE=1
#CreateFile flags
FILE_SHARE_DELETE=4
FILE_SHARE_READ=1
FILE_SHARE_WRITE=2
CREATE_NEW=1
CREATE_ALWAYS=2
OPEN_EXISTING=3
OPEN_ALWAYS=4
TRUNCATE_EXISTING=8
GENERIC_READ=long(0x80000000L)
GENERIC_WRITE=0x40000000
FILE_FLAG_BACKUP_SEMANTICS=0x2000000
FILE_NOTIFY_CHANGE_FILE_NAME=0x1
FILE_NOTIFY_CHANGE_DIR_NAME=0x2
FILE_NOTIFY_CHANGE_LAST_WRITE=0x10
FILE_LIST_DIRECTORY=0x1

FILE_ATTRIBUTE_READONLY             =0x00000001
FILE_ATTRIBUTE_HIDDEN               =0x00000002
FILE_ATTRIBUTE_SYSTEM               =0x00000004
FILE_ATTRIBUTE_DIRECTORY            =0x00000010
FILE_ATTRIBUTE_ARCHIVE              =0x00000020
FILE_ATTRIBUTE_ENCRYPTED            =0x00000040
FILE_ATTRIBUTE_NORMAL               =0x00000080
FILE_ATTRIBUTE_TEMPORARY            =0x00000100
FILE_ATTRIBUTE_SPARSE_FILE          =0x00000200
FILE_ATTRIBUTE_REPARSE_POINT        =0x00000400
FILE_ATTRIBUTE_COMPRESSED           =0x00000800
FILE_ATTRIBUTE_OFFLINE              =0x00001000
FILE_ATTRIBUTE_NOT_CONTENT_INDEXED  =0x00002000

IOCTL_BIOCGSTATS=9031
FILE_ANY_ACCESS=0

MAX_COMPUTERNAME_LENGTH = 15
HORZRES=8 #8
VERTRES=0x0a #0xa
SRCCOPY=0xcc0020
CF_BITMAP=2
DIB_RGB_COLORS=0
BI_RGB=0
GENERIC_ALL=0x10000000


KEY_READ=0x020019
KEY_WRITE=0x2001a
KEY_QUERY_VALUE=0x0001
KEY_SET_VALUE=0x0002
KEY_CREATE_SUB_KEY=0x0004
KEY_ENUMERATE_SUB_KEYS=0x0008
KEY_NOTIFY=0x0010
KEY_CREATE_LINK=0x0020
KEY_ALL_ACCESS=0xf003fL
HKEY_CLASSES_ROOT=0x80000000L
HKEY_CURRENT_USER=0x80000001L
HKEY_LOCAL_MACHINE=0x80000002L
HKEY_USERS=0x80000003L
HKEY_PERFORMANCE_DATA=0x80000004L
HKEY_CURRENT_CONFIG=0x80000005L
HKEY_DYN_DATA=0x80000006L
SYNCHRONIZE=0x00100000L

SC_MANAGER_ALL_ACCESS=0xF003F
SC_MANAGER_CONNECT=0x01
SC_MANAGER_CREATE_SERVICE=0x02
SC_MANAGER_ENUMERATE_SERVICE=0x04
SC_MANAGER_LOCK=0x08
SC_MANAGER_QUERY_LOCK_STATUS=0x10
SC_MANAGER_MODIFY_BOOT_CONFIG=0x20
SERVICE_QUERY_CONFIG=0x01
SERVICE_CHANGE_CONFIG=0x02
SERVICE_QUERY_STATUS=0x04
SERVICE_ENUMERATE_DEPENDANTS=0x08
SERVICE_CONTROL_STOP=0x01
SERVICE_START=0x10
SERVICE_STOP=0x20
SERVICE_PAUSE_CONTINUE=0x40
SERVICE_INTERROGATE=0x80
SERVICE_USER_DEFINED_CONTROL=0x100
SERVICE_STOPPED=0x01
SERVICE_START_PENDING=0x02
SERVICE_STOP_PENDING=0x03
SERVICE_USER_DEFINED_CONTROL=0x100
SERVICE_RUNNING=0x04
SERVICE_CONTINUE_PENDING=0x05
SERVICE_PAUSE_PENDING=0x06
SERVICE_PAUSED=0x07
SERVICE_ALL_ACCESS=0xF01FF


SERVICE_STATE_ALL=3
SERVICE_ACTIVE=1
SERVICE_INACTIVE=2
SERVICE_WIN32_OWN_PROCESS = 0x10
SERVICE_WIN32_SHARE_PROCESS  = 0x20
SERVICE_WIN32 = SERVICE_WIN32_OWN_PROCESS + SERVICE_WIN32_SHARE_PROCESS

SERVICE_FILE_SYSTEM_DRIVER=2
SERVICE_KERNEL_DRIVER=1
SERVICE_WIN32_OWN_PROCESS=0x10
SERVICE_WIN32_SHARE_PROCESS=0x20
SERVICE_INTERACTIVE_PROCESS=0x100

SERVICE_AUTO_START=0x2 #started by SCM
SERVICE_BOOT_START=0x0 #started by device manager at boot
SERVICE_DEMAND_START=0x3 #started using StartService
SERVICE_DISABLED=0x4 #disabled
SERVICE_SYSTEM_START=0x1 #ioinitsystem started

#error control codes
SERVICE_ERROR_IGNORE=0
SERVICE_ERROR_NORMAL=1
SERVICE_ERROR_SEVERE=2
SERVICE_ERROR_CRITICAL=3

PIPE_READMODE_MESSAGE=0x00000002
PIPE_READMODE_BYTE=0
PIPE_WAIT=0
PIPE_NOWAIT=1

SECPKG_CRED_OUTBOUND=2
SECPKG_CRED_INBOUND=1
SECPKG_CRED_BOTH=3
SC_MANAGER_CREATE_SERVICE=0x0002


MEM_COMMIT=0x1000
MEM_RESERVE=0x2000
PAGE_EXECUTE_READWRITE=0x40

FILE_MAP_ALL_ACCESS=0xf001f

SecurityAnonymous=0
SecurityIdentification=1
SecurityImpersonation=2
SecurityDelegation=3


POLICY_VIEW_LOCAL_INFORMATION=0x00000001L
POLICY_VIEW_AUDIT_INFORMATION=0x00000002L
POLICY_GET_PRIVATE_INFORMATION=0x00000004L
POLICY_TRUST_ADMIN=0x00000008L
POLICY_CREATE_ACCOUNT=0x00000010L
POLICY_CREATE_SECRET=0x00000020L
POLICY_CREATE_PRIVILEGE=0x00000040L
POLICY_SET_DEFAULT_QUOTA_LIMITS=0x00000080L
POLICY_SET_AUDIT_REQUIREMENTS=0x00000100L
POLICY_AUDIT_LOG_ADMIN=0x00000200L
POLICY_SERVER_ADMIN=0x00000400L
POLICY_LOOKUP_NAMES=0x00000800L
POLICY_NOTIFICATION=0x00001000L
#everyone says these three are the same for some reason.
STANDARD_RIGHTS_READ=0x00020000L
STANDARD_RIGHTS_WRITE=0x00020000L
STANDARD_RIGHTS_EXECUTE=0x00020000L
SPECIFIC_RIGHTS_ALL=0x0000FFFFL
STANDARD_RIGHTS_ALL=0x001F0000L
STANDARD_RIGHTS_REQUIRED=0x000f0000L
POLICY_ALL_ACCESS=STANDARD_RIGHTS_REQUIRED | 4095

STATUS_ACCESS_DENIED=0xc0000022L


MAXIMUM_ALLOWED=0x02000000L

TOKEN_DUPLICATE=0x02
TOKEN_QUERY=0x08

LOGON32_PROVIDER_DEFAULT=0
LOGON32_PROVIDER_WINNT35=1
LOGON32_PROVIDER_WINNT40=2
LOGON32_PROVIDER_WINNT50=3
LOGON32_LOGON_INTERACTIVE=2
LOGON32_LOGON_UNLOCK = 7

# EXTENDED_NAME_FORMAT enum
# https://msdn.microsoft.com/en-us/library/windows/desktop/ms724268%28v=vs.85%29.aspx
NameUnknown           = 0
NameFullyQualifiedDN  = 1
NameSamCompatible     = 2
NameDisplay           = 3
NameUniqueId          = 6
NameCanonical         = 7
NameUserPrincipal     = 8
NameCanonicalEx       = 9
NameServicePrincipal  = 10
NameDnsDomain         = 12

MOVEFILE_DELAY_UNTIL_REBOOT = 0x4

DRIVE_TYPES={"DRIVE_UNKNOWN":0, "DRIVE_NO_ROOT_DIR":1,
             "DRIVE_REMOVABLE":2, "DRIVE_FIXED":3,
             "DRIVE_REMOTE":4, "DRIVE_CDROM":5,
             "DRIVE_RAMDISK":6}

accessDict={}
accessDict["KEY_ALL_ACCESS"]         = KEY_ALL_ACCESS
accessDict["KEY_QUERY_VALUE"]        = KEY_QUERY_VALUE
accessDict["KEY_SET_VALUE"]          = KEY_SET_VALUE
accessDict["KEY_READ"]               = KEY_READ
accessDict["KEY_WRITE"]              = KEY_WRITE
accessDict["KEY_ENUMERATE_SUB_KEYS"] = KEY_ENUMERATE_SUB_KEYS

keyDict={}
keyDict["HKEY_LOCAL_MACHINE"]=HKEY_LOCAL_MACHINE
keyDict["HKEY_CURRENT_USER"]=HKEY_CURRENT_USER

TokenPrimary=1
TokenImpersonation=2

POLICY_VIEW_LOCAL_INFORMATION=0x00000001L
POLICY_VIEW_AUDIT_INFORMATION=0x00000002L
POLICY_GET_PRIVATE_INFORMATION=0x00000004L
POLICY_TRUST_ADMIN=0x00000008L
POLICY_CREATE_ACCOUNT=0x00000010L
POLICY_CREATE_SECRET=0x00000020L
POLICY_CREATE_PRIVILEGE=0x00000040L
POLICY_SET_DEFAULT_QUOTA_LIMITS=0x00000080L
POLICY_SET_AUDIT_REQUIREMENTS=0x00000100L
POLICY_AUDIT_LOG_ADMIN=0x00000200L
POLICY_SERVER_ADMIN=0x00000400L
POLICY_LOOKUP_NAMES=0x00000800L
POLICY_NOTIFICATION=0x00001000L
#everyone says these three are the same for some reason.
STANDARD_RIGHTS_READ=0x00020000L
STANDARD_RIGHTS_WRITE=0x00020000L
STANDARD_RIGHTS_EXECUTE=0x00020000L
SPECIFIC_RIGHTS_ALL=0x0000FFFFL
STANDARD_RIGHTS_ALL=0x001F0000L
STANDARD_RIGHTS_REQUIRED=0x000f0000L
POLICY_ALL_ACCESS=STANDARD_RIGHTS_REQUIRED | 4095

LOGON32_PROVIDER_DEFAULT=0
LOGON32_PROVIDER_WINNT35=1
LOGON32_PROVIDER_WINNT40=2
LOGON32_PROVIDER_WINNT50=3
LOGON32_LOGON_INTERACTIVE=2
LOGON32_LOGON_UNLOCK = 7

SECPKG_CRED_OUTBOUND=2
SECPKG_CRED_INBOUND=1
SECPKG_CRED_BOTH=3
SC_MANAGER_CREATE_SERVICE=0x0002


MAX_COMPUTERNAME_LENGTH = 15
HORZRES=8 #8
VERTRES=0x0a #0xa
SRCCOPY=0xcc0020
CF_BITMAP=2
DIB_RGB_COLORS=0
BI_RGB=0
GENERIC_ALL=0x10000000


PIPE_READMODE_MESSAGE=0x00000002
PIPE_READMODE_BYTE=0
PIPE_WAIT=0
PIPE_NOWAIT=1


SecurityAnonymous=0
SecurityIdentification=1
SecurityImpersonation=2
SecurityDelegation=3


NameUnknown           = 0
NameFullyQualifiedDN  = 1
NameSamCompatible     = 2
NameDisplay           = 3
NameUniqueId          = 6
NameCanonical         = 7
NameUserPrincipal     = 8
NameCanonicalEx       = 9
NameServicePrincipal  = 10
NameDnsDomain         = 12


win32errs={}
win32errs[3]="ERROR_PATH_NOT_FOUND"
win32errs[6]="Invalid Handle"
win32errs[0x7e]="ERROR_MOD_NOT_FOUND"
win32errs[1349]="Bad Token Type"


# TOKEN_INFORMATION_CLASS
TokenUser=1
TokenGroups=2
TokenPrivileges=3
TokenOwner=4
TokenPrimaryGroup=5
TokenDefaultDacl=6
TokenSource=7
TokenType=8
TokenImpersonationLevel=9
TokenStatistics=10
TokenRestrictedSids=11
TokenSessionId=12
TokenGroupsAndPrivileges=13
TokenSessionReference=14
TokenSandBoxInert=15
TokenAuditPolicy=16
TokenOrigin=17
TokenElevationType=18
TokenLinkedToken=19
TokenElevation=20
TokenHasRestrictions=21
TokenAccessInformation=22
TokenVirtualizationAllowed=23
TokenVirtualizationEnabled=24
TokenIntegrityLevel=25
TokenUIAccess=26
TokenMandatoryPolicy=27
TokenLogonSid=28
MaxTokenInfoClass=29


# TOKEN_ELEVATION_TYPE
TokenElevationTypeDefault=1
TokenElevationTypeFull=2
TokenElevationTypeLimited=3
