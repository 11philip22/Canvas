#!/usr/bin/env python
##ImmunityHeader v1
################################################################################
## File       :  rdpconst.py
## Description:
##            :
## Created_On :  Thu May 23 2019

## Created_By :  X.
##
## (c) Copyright 2010, Immunity, Inc. all rights reserved.
################################################################################

###
# Logging flags
###

RDP_LOG_NONE  = (0)
RDP_LOG_INFO  = (1<<0)
RDP_LOG_DEBUG = (1<<1)
RDP_LOG_WARN  = (1<<2)
RDP_LOG_ERROR = (1<<3)

###
# [MS-RDPEFS] Constants (RDPDR channel)
###

# 2.2.1.1 Shared Header (RDPDR_HEADER)

RDPDR_CTYP_CORE = 0x4472
RDPDR_CTYP_PRN  = 0x5052

PAKID_CORE_SERVER_ANNOUNCE     = 0x496E
PAKID_CORE_CLIENTID_CONFIRM    = 0x4343
PAKID_CORE_CLIENT_NAME         = 0x434E
PAKID_CORE_DEVICELIST_ANNOUNCE = 0x4441
PAKID_CORE_DEVICE_REPLY        = 0x6472
PAKID_CORE_DEVICE_IOREQUEST    = 0x4952
PAKID_CORE_DEVICE_IOCOMPLETION = 0x4943
PAKID_CORE_SERVER_CAPABILITY   = 0x5350
PAKID_CORE_CLIENT_CAPABILITY   = 0x4350
PAKID_CORE_DEVICELIST_REMOVE   = 0x444D
PAKID_PRN_CACHE_DATA           = 0x5043 
PAKID_CORE_USER_LOGGEDON       = 0x554C
PAKID_PRN_USING_XPS            = 0x5543

###
# [MS-RDPBCGR] Constants
###

# 2.2.1.1 Client X.224 Connection Request PDU

X224_CONNECTION_REQUEST_CODE = 14
X224_CONNECTION_CONFIRM_CODE = 13
X224_DISCONNECT_REQUEST_CODE = 8
X224_DISCONNECT_CONFIRM_CODE = 12
X224_DATA_CODE               = 15

# 2.2.1.1.1 RDP Negotiation Request (RDP_NEG_REQ)

TYPE_RDP_NEG_REQ = 0x01
TYPE_RDP_NEG_RSP = 0x02

RESTRICTED_ADMIN_MODE_REQUIRED          = 0x01
REDIRECTED_AUTHENTICATION_MODE_REQUIRED = 0x02
CORRELATION_INFO_PRESENT                = 0x08

PROTOCOL_RDP       = 0x00
PROTOCOL_SSL       = 0x01
PROTOCOL_HYBRID    = 0x02
PROTOCOL_RDSTLS    = 0x04
PROTOCOL_HYBRID_EX = 0x08

# 2.2.1.2.1 RDP Negotiation Response (RDP_NEG_RSP)

EXTENDED_CLIENT_DATA_SUPPORTED           = 0x01
DYNVC_GFX_PROTOCOL_SUPPORTED             = 0x02
NEGRSP_FLAG_RESERVED                     = 0x04
RESTRICTED_ADMIN_MODE_SUPPORTED          = 0x08
REDIRECTED_AUTHENTICATION_MODE_SUPPORTED = 0x10

SSL_REQUIRED_BY_SERVER                = 0x00000001
SSL_NOT_ALLOWED_BY_SERVER             = 0x00000002
SSL_CERT_NOT_ON_SERVER                = 0x00000003
INCONSISTENT_FLAGS                    = 0x00000004
HYBRID_REQUIRED_BY_SERVER             = 0x00000005
SSL_WITH_USER_AUTH_REQUIRED_BY_SERVER = 0x00000006

# 2.2.1.3.1 User Data Header (TS_UD_HEADER)

CS_CORE           = 0xC001
CS_SECURITY       = 0xC002
CS_NET            = 0xC003
CS_CLUSTER        = 0xC004
CS_MONITOR        = 0xC005
CS_MCS_MSGCHANNEL = 0xC006
CS_MONITOR_EX     = 0xC008
CS_MULTITRANSPORT = 0xC00A

SC_CORE           = 0x0C01
SC_SECURITY       = 0x0C02
SC_NET            = 0x0C03
SC_MCS_MSGCHANNEL = 0x0C04
SC_MULTITRANSPORT = 0x0C08

# 2.2.1.3.2 Client Core Data (TS_UD_CS_CORE)

RDP_CLT_VER_4_0  = 0x00080001 # RDP 4.0 clients
RDP_CLT_VER_5_0  = 0x00080004 # RDP 5.0, 5.1, 5.2, 6.0, 6.1, 7.0, 7.1, 8.0, and 8.1 clients
RDP_CLT_VER_10_0 = 0x00080005 # RDP 10.0 clients
RDP_CLT_VER_10_1 = 0x00080006 # RDP 10.1 clients
RDP_CLT_VER_10_2 = 0x00080007 # RDP 10.2 clients
RDP_CLT_VER_10_3 = 0x00080008 # RDP 10.3 clients
RDP_CLT_VER_10_4 = 0x00080009 # RDP 10.4 clients
RDP_CLT_VER_10_5 = 0x0008000A # RDP 10.5 clients
RDP_CLT_VER_10_6 = 0x0008000B # RDP 10.6 clients
RDP_CLT_VER_10_7 = 0x0008000C # RDP 10.7 clients

RNS_UD_COLOR_4BPP      = 0xca00 # 4 bits-per-pixel (bpp)
RNS_UD_COLOR_8BPP      = 0xca01 # 8 bpp
RNS_UD_COLOR_16BPP_555 = 0xca02 # 15-bit 555 RGB mask (5 bits for red, 5 bits for green, and 5 bits for blue)
RNS_UD_COLOR_16BPP_565 = 0xca03 # 16-bit 565 RGB mask (5 bits for red, 6 bits for green, and 5 bits for blue)
RNS_UD_COLOR_24BPP     = 0xca04 # 24-bit RGB mask (8 bits for red, 8 bits for green, and 8 bits for blue)

KEYBOARD_TYPE_IBM_PCXT   = 0x00000001 # IBM PC/XT or compatible (83-key) keyboard
KEYBOARD_TYPE_OLIVETTI   = 0x00000002 # Olivetti "ICO" (102-key) keyboard
KEYBOARD_TYPE_IBM_PCAT   = 0x00000003 # IBM PC/AT (84-key) and similar keyboards
KEYBOARD_TYPE_IBM_ENH    = 0x00000004 # IBM enhanced (101-key or 102-key) keyboard
KEYBOARD_TYPE_NOKIA_1050 = 0x00000005 # Nokia 1050 and similar keyboards
KEYBOARD_TYPE_NOKIA_9140 = 0x00000006 # Nokia 9140 and similar keyboards
KEYBOARD_TYPE_JAP        = 0x00000007 # Japanese keyboard

HIGH_COLOR_4BPP  = 0x0004 # 4 bpp
HIGH_COLOR_8BPP  = 0x0008 # 8 bpp
HIGH_COLOR_15BPP = 0x000F # 15-bit 555 RGB mask (5 bits for red, 5 bits for green, and 5 bits for blue)
HIGH_COLOR_16BPP = 0x0010 # 16-bit 565 RGB mask (5 bits for red, 6 bits for green, and 5 bits for blue)
HIGH_COLOR_24BPP = 0x0018 # 24-bit RGB mask (8 bits for red, 8 bits for green, and 8 bits for blue)

RNS_UD_CS_SUPPORT_ERRINFO_PDU        = 0x0001
RNS_UD_CS_WANT_32BPP_SESSION         = 0x0002
RNS_UD_CS_SUPPORT_STATUSINFO_PDU     = 0x0004
RNS_UD_CS_STRONG_ASYMMETRIC_KEYS     = 0x0008
RNS_UD_CS_UNUSED                     = 0x0010
RNS_UD_CS_VALID_CONNECTION_TYPE      = 0x0020
RNS_UD_CS_SUPPORT_MONITOR_LAYOUT_PDU = 0x0040
RNS_UD_CS_SUPPORT_NETCHAR_AUTODETECT = 0x0080
RNS_UD_CS_SUPPORT_DYNVC_GFX_PROTOCOL = 0x0100
RNS_UD_CS_SUPPORT_DYNAMIC_TIME_ZONE  = 0x0200
RNS_UD_CS_SUPPORT_HEARTBEAT_PDU      = 0x0400

CONNECTION_TYPE_MODEM          = 0x01
CONNECTION_TYPE_BROADBAND_LOW  = 0x02
CONNECTION_TYPE_SATELLITE      = 0x03
CONNECTION_TYPE_BROADBAND_HIGH = 0x04
CONNECTION_TYPE_WAN            = 0x05
CONNECTION_TYPE_LAN            = 0x06
CONNECTION_TYPE_AUTODETECT     = 0x07

# 2.2.1.3.3 Client Security Data (TS_UD_CS_SEC)

c40BIT_ENCRYPTION_FLAG  = 0x00000001
c128BIT_ENCRYPTION_FLAG = 0x00000002
c56BIT_ENCRYPTION_FLAG  = 0x00000008
cFIPS_ENCRYPTION_FLAG   = 0x00000010

# 2.2.1.3.4 Client Network Data (TS_UD_CS_NET)

CHANNEL_OPTION_INITIALIZED   = 0x80000000 
CHANNEL_OPTION_ENCRYPT_RDP   = 0x40000000
CHANNEL_OPTION_ENCRYPT_SC    = 0x20000000
CHANNEL_OPTION_ENCRYPT_CS    = 0x10000000
CHANNEL_OPTION_PRI_HIGH      = 0x08000000
CHANNEL_OPTION_PRI_MED       = 0x04000000
CHANNEL_OPTION_PRI_LOW       = 0x02000000
CHANNEL_OPTION_COMPRESS_RDP  = 0x00800000
CHANNEL_OPTION_COMPRESS      = 0x00400000
CHANNEL_OPTION_SHOW_PROTOCOL = 0x00200000
REMOTE_CONTROL_PERSISTENT    = 0x00100000

# 2.2.1.3.5 Client Cluster Data (TS_UD_CS_CLUSTER)

REDIRECTION_SUPPORTED               = 0x00000001
ServerSessionRedirectionVersionMask = 0x0000003C
REDIRECTED_SESSIONID_FIELD_VALID    = 0x00000002
REDIRECTED_SMARTCARD                = 0x00000040

REDIRECTION_VERSION1 = 0x00
REDIRECTION_VERSION2 = 0x01
REDIRECTION_VERSION3 = 0x02
REDIRECTION_VERSION4 = 0x03
REDIRECTION_VERSION5 = 0x04
REDIRECTION_VERSION6 = 0x05

# 2.2.1.3.8 Client Multitransport Channel Data (TS_UD_CS_MULTITRANSPORT)

TRANSPORTTYPE_UDPFECR       = 0x01
TRANSPORTTYPE_UDPFECL       = 0x04
TRANSPORTTYPE_UDP_PREFERRED = 0x100
SOFTSYNC_TCP_TO_UDP         = 0x200

# 2.2.1.4.3 Server Security Data (TS_UD_SC_SEC1)

ENCRYPTION_METHOD_NONE   = 0x00000000
ENCRYPTION_METHOD_40BIT  = 0x00000001
ENCRYPTION_METHOD_128BIT = 0x00000002
ENCRYPTION_METHOD_56BIT  = 0x00000008
ENCRYPTION_METHOD_FIPS   = 0x00000010
ENCRYPTION_METHOD_ALL    = ENCRYPTION_METHOD_40BIT | ENCRYPTION_METHOD_128BIT | ENCRYPTION_METHOD_56BIT | ENCRYPTION_METHOD_FIPS

ENCRYPTION_LEVEL_NONE              = 0x00000000
ENCRYPTION_LEVEL_LOW               = 0x00000001
ENCRYPTION_LEVEL_CLIENT_COMPATIBLE = 0x00000002
ENCRYPTION_LEVEL_HIGH              = 0x00000003
ENCRYPTION_LEVEL_FIPS              = 0x00000004

# 2.2.1.4.3.1 Server Certificate (SERVER_CERTIFICATE)

CERT_CHAIN_VERSION_1 = 0x00000001
CERT_CHAIN_VERSION_2 = 0x00000002

# 2.2.1.10.1 Security Exchange PDU Data (TS_SECURITY_PACKET)

SEC_EXCHANGE_PKT       = 0x0001
SEC_TRANSPORT_REQ      = 0x0002
RDP_SEC_TRANSPORT_RSP  = 0x0004
SEC_ENCRYPT            = 0x0008
SEC_RESET_SEQNO        = 0x0010
SEC_IGNORE_SEQNO       = 0x0020
SEC_INFO_PKT           = 0x0040
SEC_LICENSE_PKT        = 0x0080
SEC_LICENSE_ENCRYPT_CS = 0x0200
SEC_LICENSE_ENCRYPT_SC = 0x0200
SEC_REDIRECTION_PKT    = 0x0400
SEC_SECURE_CHECKSUM    = 0x0800
SEC_AUTODETECT_REQ     = 0x1000
SEC_AUTODETECT_RSP     = 0x2000

# 2.2.1.11.1.1 Info Packet (TS_INFO_PACKET)

INFO_MOUSE                  = 0x00000001
INFO_DISABLECTRLALTDEL      = 0x00000002
INFO_AUTOLOGON              = 0x00000008
INFO_UNICODE                = 0x00000010
INFO_MAXIMIZESHELL          = 0x00000020
INFO_LOGONNOTIFY            = 0x00000040
INFO_COMPRESSION            = 0x00000080
INFO_ENABLEWINDOWSKEY       = 0x00000100
INFO_REMOTECONSOLEAUDIO     = 0x00002000
INFO_FORCE_ENCRYPTED_CS_PDU = 0x00004000
INFO_RAIL                   = 0x00008000
INFO_LOGONERRORS            = 0x00010000
INFO_MOUSE_HAS_WHEEL        = 0x00020000
INFO_PASSWORD_IS_SC_PIN     = 0x00040000
INFO_NOAUDIOPLAYBACK        = 0x00080000
INFO_USING_SAVED_CREDS      = 0x00100000
INFO_AUDIOCAPTURE           = 0x00200000
INFO_VIDEO_DISABLE          = 0x00400000
INFO_RESERVED1              = 0x00800000
INFO_RESERVED2              = 0x01000000
INFO_HIDEF_RAIL_SUPPORTED   = 0x02000000

# 2.2.1.11.1.1.1 Extended Info Packet (TS_EXTENDED_INFO_PACKET)

AF_INET  = 0x0002
AF_INET6 = 0x0017

PERF_DISABLE_WALLPAPER          = 0x00000001
PERF_DISABLE_FULLWINDOWDRAG     = 0x00000002
PERF_DISABLE_MENUANIMATIONS     = 0x00000004
PERF_DISABLE_THEMING            = 0x00000008
PERF_RESERVED1                  = 0x00000010
PERF_DISABLE_CURSOR_SHADOW      = 0x00000020
PERF_DISABLE_CURSORSETTINGS     = 0x00000040
PERF_ENABLE_FONT_SMOOTHING      = 0x00000080
PERF_ENABLE_DESKTOP_COMPOSITION = 0x00000100
PERF_RESERVED2                  = 0x80000000

# 2.2.1.13.1.1.1 Capability Set (TS_CAPS_SET)

CAPSTYPE_GENERAL                 = 0x0001
CAPSTYPE_BITMAP                  = 0x0002
CAPSTYPE_ORDER                   = 0x0003
CAPSTYPE_BITMAPCACHE             = 0x0004
CAPSTYPE_CONTROL                 = 0x0005
CAPSTYPE_ACTIVATION              = 0x0007
CAPSTYPE_POINTER                 = 0x0008
CAPSTYPE_SHARE                   = 0x0009
CAPSTYPE_COLORCACHE              = 0x000A
CAPSTYPE_SOUND                   = 0x000C
CAPSTYPE_INPUT                   = 0x000D
CAPSTYPE_FONT                    = 0x000E
CAPSTYPE_BRUSH                   = 0x000F
CAPSTYPE_GLYPHCACHE              = 0x0010
CAPSTYPE_OFFSCREENCACHE          = 0x0011
CAPSTYPE_BITMAPCACHE_HOSTSUPPORT = 0x0012
CAPSTYPE_BITMAPCACHE_REV2        = 0x0013
CAPSTYPE_VIRTUALCHANNEL          = 0x0014
CAPSTYPE_DRAWNINEGRIDCACHE       = 0x0015
CAPSTYPE_DRAWGDIPLUS             = 0x0016
CAPSTYPE_RAIL                    = 0x0017
CAPSTYPE_WINDOW                  = 0x0018
CAPSETTYPE_COMPDESK              = 0x0019
CAPSETTYPE_MULTIFRAGMENTUPDATE   = 0x001A
CAPSETTYPE_LARGE_POINTER         = 0x001B
CAPSETTYPE_SURFACE_COMMANDS      = 0x001C
CAPSETTYPE_BITMAP_CODECS         = 0x001D
CAPSSETTYPE_FRAME_ACKNOWLEDGE    = 0x001E

# 2.2.1.14.1 Synchronize PDU Data (TS_SYNCHRONIZE_PDU)

SYNCMSGTYPE_SYNC = 1

# 2.2.1.15.1 Control PDU Data (TS_CONTROL_PDU)

CTRLACTION_REQUEST_CONTROL = 0x0001
CTRLACTION_GRANTED_CONTROL = 0x0002
CTRLACTION_DETACH          = 0x0003
CTRLACTION_COOPERATE       = 0x0004

# 2.2.6.1 Virtual Channel PDU

CHANNEL_CHUNK_LENGTH = 1600

# 2.2.6.1.1 Channel PDU Header (CHANNEL_PDU_HEADER)

CHANNEL_FLAG_FIRST             = 0x00000001
CHANNEL_FLAG_LAST              = 0x00000002
CHANNEL_FLAG_SHOW_PROTOCOL     = 0x00000010
CHANNEL_FLAG_SUSPEND           = 0x00000020
CHANNEL_FLAG_RESUME            = 0x00000040
CHANNEL_FLAG_SHADOW_PERSISTENT = 0x00000080
CHANNEL_PACKET_COMPRESSED      = 0x00200000
CHANNEL_PACKET_AT_FRONT        = 0x00400000
CHANNEL_PACKET_FLUSHED         = 0x00800000
CompressionTypeMask            = 0x000F0000

# 2.2.7.1.1 General Capability Set (TS_GENERAL_CAPABILITYSET)

OSMAJORTYPE_UNSPECIFIED = 0x0000
OSMAJORTYPE_WINDOWS     = 0x0001
OSMAJORTYPE_OS2         = 0x0002
OSMAJORTYPE_MACINTOSH   = 0x0003
OSMAJORTYPE_UNIX        = 0x0004
OSMAJORTYPE_IOS         = 0x0005
OSMAJORTYPE_OSX         = 0x0006
OSMAJORTYPE_ANDROID     = 0x0007
OSMAJORTYPE_CHROME_OS   = 0x0008

OSMINORTYPE_UNSPECIFIED    = 0x0000
OSMINORTYPE_WINDOWS_31X    = 0x0001
OSMINORTYPE_WINDOWS_95     = 0x0002
OSMINORTYPE_WINDOWS_NT     = 0x0003
OSMINORTYPE_OS2_V21        = 0x0004
OSMINORTYPE_POWER_PC       = 0x0005
OSMINORTYPE_MACINTOSH      = 0x0006
OSMINORTYPE_NATIVE_XSERVER = 0x0007
OSMINORTYPE_PSEUDO_XSERVER = 0x0008
OSMINORTYPE_WINDOWS_RT     = 0x0009

# extraFlags
FASTPATH_OUTPUT_SUPPORTED  = 0x0001
NO_BITMAP_COMPRESSION_HDR  = 0x0400
LONG_CREDENTIALS_SUPPORTED = 0x0004
AUTORECONNECT_SUPPORTED    = 0x0008
ENC_SALTED_CHECKSUM        = 0x0010

TS_CAPS_PROTOCOLVERSION    = 0x0200

# 2.2.7.1.2 Bitmap Capability Set (TS_BITMAP_CAPABILITYSET)

DRAW_ALLOW_DYNAMIC_COLOR_FIDELITY = 0x02
DRAW_ALLOW_COLOR_SUBSAMPLING      = 0x04
DRAW_ALLOW_SKIP_ALPHA             = 0x08
DRAW_UNUSED_FLAG                  = 0x10

# 2.2.7.1.3 Order Capability Set (TS_ORDER_CAPABILITYSET)

NEGOTIATEORDERSUPPORT   = 0x0002
ZEROBOUNDSDELTASSUPPORT = 0x0008
COLORINDEXSUPPORT       = 0x0020
SOLIDPATTERNBRUSHONLY   = 0x0040
ORDERFLAGS_EXTRA_FLAGS  = 0x0080

TS_NEG_DSTBLT_INDEX             = 0x00
TS_NEG_PATBLT_INDEX             = 0x01
TS_NEG_SCRBLT_INDEX             = 0x02
TS_NEG_MEMBLT_INDEX             = 0x03
TS_NEG_MEM3BLT_INDEX            = 0x04
TS_NEG_DRAWNINEGRID_INDEX       = 0x07
TS_NEG_LINETO_INDEX             = 0x08
TS_NEG_MULTI_DRAWNINEGRID_INDEX = 0x09
TS_NEG_SAVEBITMAP_INDEX         = 0x0B
TS_NEG_MULTIDSTBLT_INDEX        = 0x0F
TS_NEG_MULTIPATBLT_INDEX        = 0x10
TS_NEG_MULTISCRBLT_INDEX        = 0x11
TS_NEG_MULTIOPAQUERECT_INDEX    = 0x12
TS_NEG_FAST_INDEX_INDEX         = 0x13
TS_NEG_POLYGON_SC_INDEX         = 0x14
TS_NEG_POLYGON_CB_INDEX         = 0x15
TS_NEG_POLYLINE_INDEX           = 0x16
TS_NEG_FAST_GLYPH_INDEX         = 0x18
TS_NEG_ELLIPSE_SC_INDEX         = 0x19
TS_NEG_ELLIPSE_CB_INDEX         = 0x1A
TS_NEG_INDEX_INDEX              = 0x1B

ORDERFLAGS_EX_CACHE_BITMAP_REV3_SUPPORT   = 0x0002
ORDERFLAGS_EX_ALTSEC_FRAME_MARKER_SUPPORT = 0x0004

ORD_LEVEL_1_ORDERS = 1

# 2.2.7.1.6 Input Capability Set (TS_INPUT_CAPABILITYSET)

INPUT_FLAG_SCANCODES         = 0x0001
INPUT_FLAG_MOUSEX            = 0x0004
INPUT_FLAG_FASTPATH_INPUT    = 0x0008
INPUT_FLAG_UNICODE           = 0x0010
INPUT_FLAG_FASTPATH_INPUT2   = 0x0020
INPUT_FLAG_UNUSED1           = 0x0040
INPUT_FLAG_UNUSED2           = 0x0080
TS_INPUT_FLAG_MOUSE_HWHEEL   = 0x0100
TS_INPUT_FLAG_QOE_TIMESTAMPS = 0x0200

# 2.2.7.1.7 Brush Capability Set (TS_BRUSH_CAPABILITYSET)

BRUSH_DEFAULT    = 0x00000000
BRUSH_COLOR_8x8  = 0x00000001
BRUSH_COLOR_FULL = 0x00000002

# 2.2.7.1.10 Virtual Channel Capability Set (TS_VIRTUALCHANNEL_CAPABILITYSET)

VCCAPS_NO_COMPR    = 0x00000000
VCCAPS_COMPR_SC    = 0x00000001
VCCAPS_COMPR_CS_8K = 0x00000002

# 2.2.7.1.11 Sound Capability Set (TS_SOUND_CAPABILITYSET)

SOUND_BEEPS_FLAG = 0x0001

# 2.2.7.2.2 Control Capability Set (TS_CONTROL_CAPABILITYSET)

CONTROLPRIORITY_NEVER = 0x0002

# 2.2.7.2.5 Font Capability Set (TS_FONT_CAPABILITYSET)

FONTSUPPORT_FONTLIST = 0x0001

# 2.2.7.2.7 Large Pointer Capability Set (TS_LARGE_POINTER_CAPABILITYSET)

LARGE_POINTER_FLAG_96x96   = 0x00000001
LARGE_POINTER_FLAG_384x384 = 0x00000002

# 2.2.8.1.1.1.1 Share Control Header (TS_SHARECONTROLHEADER)

PDUTYPE_DEMANDACTIVEPDU  = 0x1
PDUTYPE_CONFIRMACTIVEPDU = 0x3
PDUTYPE_DEACTIVATEALLPDU = 0x6
PDUTYPE_DATAPDU          = 0x7
PDUTYPE_SERVER_REDIR_PKT = 0xA

TS_PROTOCOL_VERSION = 0x1

# 2.2.8.1.1.1.2 Share Data Header (TS_SHAREDATAHEADER)

STREAM_UNDEFINED = 0x00
STREAM_LOW       = 0x01
STREAM_MED       = 0x02
STREAM_HI        = 0x04

PDUTYPE2_UPDATE                      = 0x02
PDUTYPE2_CONTROL                     = 0x14
PDUTYPE2_POINTER                     = 0x1B
PDUTYPE2_INPUT                       = 0x1C
PDUTYPE2_SYNCHRONIZE                 = 0x1F
PDUTYPE2_REFRESH_RECT                = 0x21
PDUTYPE2_PLAY_SOUND                  = 0x22
PDUTYPE2_SUPPRESS_OUTPUT             = 0x23
PDUTYPE2_SHUTDOWN_REQUEST            = 0x24
PDUTYPE2_SHUTDOWN_DENIED             = 0x25
PDUTYPE2_SAVE_SESSION_INFO           = 0x26
PDUTYPE2_FONTLIST                    = 0x27
PDUTYPE2_FONTMAP                     = 0x28
PDUTYPE2_SET_KEYBOARD_INDICATORS     = 0x29
PDUTYPE2_BITMAPCACHE_PERSISTENT_LIST = 0x2B
PDUTYPE2_BITMAPCACHE_ERROR_PDU       = 0x2C
PDUTYPE2_SET_KEYBOARD_IME_STATUS     = 0x2D
PDUTYPE2_OFFSCRCACHE_ERROR_PDU       = 0x2E
PDUTYPE2_SET_ERROR_INFO_PDU          = 0x2F
PDUTYPE2_DRAWNINEGRID_ERROR_PDU      = 0x30
PDUTYPE2_DRAWGDIPLUS_ERROR_PDU       = 0x31
PDUTYPE2_ARC_STATUS_PDU              = 0x32
PDUTYPE2_STATUS_INFO_PDU             = 0x36
PDUTYPE2_MONITOR_LAYOUT_PDU          = 0x37

CompressionTypeMask = 0x0F #Indicates the package which was used for compression
PACKET_COMPRESSED   = 0x20
PACKET_AT_FRONT     = 0x40
PACKET_FLUSHED      = 0x80

PACKET_COMPR_TYPE_8K    = 0x0
PACKET_COMPR_TYPE_64K   = 0x1
PACKET_COMPR_TYPE_RDP6  = 0x2
PACKET_COMPR_TYPE_RDP61 = 0x3

# 2.2.1.17.1 Persistent Key List PDU Data (TS_BITMAPCACHE_PERSISTENT_LIST_PDU)

PERSIST_FIRST_PDU = 0x01
PERSIST_LAST_PDU  = 0x02

# 2.2.1.18.1 Font List PDU Data (TS_FONT_LIST_PDU)

FONTLIST_FIRST = 0x0001
FONTLIST_LAST  = 0x0002

# 2.2.8.1.1.3.1.1 Slow-Path Input Event (TS_INPUT_EVENT)

INPUT_EVENT_SYNC     = 0x0000
INPUT_EVENT_UNUSED   = 0x0002
INPUT_EVENT_SCANCODE = 0x0004
INPUT_EVENT_UNICODE  = 0x0005
INPUT_EVENT_MOUSE    = 0x8001
INPUT_EVENT_MOUSEX   = 0x8002

# 2.2.8.1.1.3.1.1.1 Keyboard Event (TS_KEYBOARD_EVENT)

KBDFLAGS_EXTENDED  = 0x0100
KBDFLAGS_EXTENDED1 = 0x0200
KBDFLAGS_DOWN      = 0x4000
KBDFLAGS_RELEASE   = 0x8000

# 2.2.8.1.1.3.1.1.3 Mouse Event (TS_POINTER_EVENT)

PTRFLAGS_HWHEEL         = 0x0400
PTRFLAGS_WHEEL          = 0x0200
PTRFLAGS_WHEEL_NEGATIVE = 0x0100
WheelRotationMask       = 0x01FF

PTRFLAGS_MOVE = 0x0800

PTRFLAGS_DOWN    = 0x8000
PTRFLAGS_BUTTON1 = 0x1000
PTRFLAGS_BUTTON2 = 0x2000
PTRFLAGS_BUTTON3 = 0x4000

# 2.2.8.1.1.3.1.1.4 Extended Mouse Event (TS_POINTERX_EVENT)

PTRXFLAGS_DOWN    = 0x8000
PTRXFLAGS_BUTTON1 = 0x0001
PTRXFLAGS_BUTTON2 = 0x0002

# 2.2.8.1.1.3.1.1.5 Synchronize Event (TS_SYNC_EVENT)

TS_SYNC_SCROLL_LOCK = 0x00000001
TS_SYNC_NUM_LOCK    = 0x00000002
TS_SYNC_CAPS_LOCK   = 0x00000004
TS_SYNC_KANA_LOCK   = 0x00000008

# 2.2.9.1.2 Server Fast-Path Update PDU (TS_FP_UPDATE_PDU)

FASTPATH_OUTPUT_ACTION_FASTPATH = 0
FASTPATH_OUTPUT_ACTION_X224     = 3

FASTPATH_OUTPUT_SECURE_CHECKSUM = 0x1
FASTPATH_OUTPUT_ENCRYPTED       = 0x2

# 2.2.9.1.2.1 Fast-Path Update (TS_FP_UPDATE)

FASTPATH_UPDATETYPE_ORDERS        = 0x0
FASTPATH_UPDATETYPE_BITMAP        = 0x1
FASTPATH_UPDATETYPE_PALETTE       = 0x2
FASTPATH_UPDATETYPE_SYNCHRONIZE   = 0x3
FASTPATH_UPDATETYPE_SURFCMDS      = 0x4
FASTPATH_UPDATETYPE_PTR_NULL      = 0x5
FASTPATH_UPDATETYPE_PTR_DEFAULT   = 0x6
FASTPATH_UPDATETYPE_PTR_POSITION  = 0x8
FASTPATH_UPDATETYPE_COLOR         = 0x9
FASTPATH_UPDATETYPE_CACHED        = 0xA
FASTPATH_UPDATETYPE_POINTER       = 0xB
FASTPATH_UPDATETYPE_LARGE_POINTER = 0xC

FASTPATH_FRAGMENT_SINGLE = 0x0
FASTPATH_FRAGMENT_LAST   = 0x1
FASTPATH_FRAGMENT_FIRST  = 0x2
FASTPATH_FRAGMENT_NEXT   = 0x3

FASTPATH_OUTPUT_COMPRESSION_USED = 0x2
