#! /usr/bin/env python

#Proprietary CANVAS source code - use only under the license agreement
#specified in LICENSE.txt in your CANVAS distribution
#Copyright Immunity, Inc, 2002-2004
#http://www.immunityinc.com/CANVAS/ for more information

#This is a dict of modules that will be called with the proper parameters (if any).
#Each of the "Checks" will be called before calling and loading the module, with the proper parameters (if any).
#If one check fails, then the module is considered not vulnerable and it is not run.
#Syntax is:
#Example Module with two parameters, with two checks with two parameters each:
#CANVAS_MODULES = dict()
#CANVAS_MODULES["Module_Name"] = { 
#   "Params": {"ParamName":"ParamValue", "ParamName2": "ParamValue2"}, 
#   "Checks": [
#                 {"Check": "CheckName", 
#                  "Params": ["Param1, "Param2"]},
#                 {"Check": "CheckName1", 
#                 "Params": ["Param1, "Param2"]}
#             ]
#}

CANVAS_MODULES = dict()
CANVAS_MODULES = {   
    'linux_foll_write_cow': {   'Checks': [   {   'Check': 'is_release_between',
                                                  'Params': ["20080101","20161001"]}],
                                'Params': None},
    'setuid': {   'Checks': [   {   'Check': 'is_euid',
                                    'Params': [   0]}],
                  'Params': {   'userid': 0}},
    'sudo_elevate': {   'Checks': None,
                        'Params': None},
    'sudo_timestamp': {   'Checks': None,
                          'Params': None}
}



MODULES_BLACKLIST = ["show_timer_leak",
                     "spectre_file_leak",
                     "dmesg_leak",
                     "dir",
                     "runcommand",
                     "whoami",
                     "autoprivesc",
                     "spawn",
                     "thunderbird_backdoor_deployer",
                     "startup",
                     "exitprocess",
                     "pty_shell",
                     "kerberos_ticket_export",
                     "ps",
                     "deluser",
                     "switch_user",
                     "adduser",
                     "converttomosdef",
                     "pcap_sniffer",
                     "unix_resolver"
                     "getpid",
                     "chdir",
                     "checkvm",
                     "getcwd",
                     "drinkcoaster",
                     "getarch",
                     "gethostbyname",
                     "GetRoot",
                     "enumservices",
                     "getpid",
                     "memory_harvest",
                     "rmdir",
                     "computername",
                     "kerberos_ticket_list",
                     "screengrab",
                     "unlink",
                     "sysinfo",
                     "tcphostfind",
                     "NetworkManagerUnSecret",
                     "killprocess",
                     "meltdown_file_leak",
                     "CVE_2011_1485",
                     "android_hotplug",
                     "CVE_2010_3847",
                     "CVE_2010_3856",
                     "CVE_2011_1485",
                     "CVE_2011_1485_Diskless",
                     "chfnescape"]

#We'll blacklist any kernel exploit dated before dirtycow.
MODULES_BLACKLIST += [
                    "CVE_2012_0056",
                    "fs_pipe_race_to_null",
                    "linux_futex_requeue",
                    "linux_pppol2tp",
                    "linux_ptrace_setregs",
                    "linux_rds",
                    "linux_tty_race",
                    "overlayfs",
                    "overlayfs_setattr",
                    "perf_swevent_init",
                    "proto_ops_null",
                    "recvmmsg",
                    "udevd"
                    ]