# SMB2 Header Flags
SMB2_FLAGS_SERVER_TO_REDIR    = 0x00000001
SMB2_FLAGS_ASYNC_COMMAND      = 0x00000002
SMB2_FLAGS_RELATED_OPERATIONS = 0x00000004
SMB2_FLAGS_SIGNED             = 0x00000008
SMB2_FLAGS_DFS_OPERATIONS     = 0x10000000

# SMB2 Header Commands
SMB2_NEGOTIATE                = 0x0000
SMB2_SESSION_SETUP            = 0x0001
SMB2_LOGOFF                   = 0x0002
SMB2_TREE_CONNECT             = 0x0003
SMB2_TREE_DISCONNECT          = 0x0004
SMB2_CREATE                   = 0x0005
SMB2_CLOSE                    = 0x0006
SMB2_FLUSH                    = 0x0007
SMB2_READ                     = 0x0008
SMB2_WRITE                    = 0x0009
SMB2_LOCK                     = 0x000A
SMB2_IOCTL                    = 0x000B
SMB2_CANCEL                   = 0x000C
SMB2_ECHO                     = 0x000D
SMB2_QUERY_DIRECTORY          = 0x000E
SMB2_CHANGE_NOTIFY            = 0x000F
SMB2_QUERY_INFO               = 0x0010
SMB2_SET_INFO                 = 0x0011
SMB2_OPLOCK_BREAK             = 0x0012
SMB2_ERROR                    = 0xFFFF

# SMB2 Structure Sizes
SMB2_HEADER_SIZE              = 64

# SMB2 Negotiate Security Mode
SMB2_NEGOTIATE_SIGNING_ENABLED  = 0x0001
SMB2_NEGOTIATE_SIGNING_REQUIRED = 0x0002

# SMB2 Negotiate Capabilities
SMB2_GLOBAL_CAP_DFS             = 0x00000001
SMB2_GLOBAL_CAP_LEASING         = 0x00000002

# SMB2 Session Flags
SMB2_SESSION_FLAG_IS_GUEST      = 0x0001
SMB2_SESSION_FLAG_IS_NULL       = 0x0002

# SMB2 Share Types
SMB2_SHARE_TYPE_DISK            = 0x01
SMB2_SHARE_TYPE_PIPE            = 0x02
SMB2_SHARE_TYPE_PRINT           = 0x03

# SMB2 Share Flags
SMB2_SHAREFLAG_MANUAL_CACHING   = 0x00000000
SMB2_SHAREFLAG_AUTO_CACHING     = 0x00000010
SMB2_SHAREFLAG_VDO_CACHING      = 0x00000020
SMB2_SHAREFLAG_NO_CACHING       = 0x00000040
SHI1005_FLAGS_DFS               = 0x00000001
SHI1005_FLAGS_DFS_ROOT          = 0x00000002
SHI1005_FLAGS_RESTRICT_EXCLUSIVE_OPENS    = 0x00000100
SHI1005_FLAGS_FORCE_SHARED_DELETE         = 0x00000200
SHI1005_FLAGS_ALLOW_NAMESPACE_CACHING     = 0x00000400
SHI1005_FLAGS_ACCESS_BASED_DIRECTORY_ENUM = 0x00000800
SHI1005_FLAGS_FORCE_LEVELII_OPLOCK        = 0x00001000
SHI1005_FLAGS_ENABLE_HASH                 = 0x00002000

# SMB2 Share Capabilities
SMB2_SHARE_CAP_DFS              = 0x00000008

# SMB2 Oplock Levels
SMB2_OPLOCK_LEVEL_NONE          = 0x00
SMB2_OPLOCK_LEVEL_II            = 0x01
SMB2_OPLOCK_LEVEL_EXCLUSIVE     = 0x08
SMB2_OPLOCK_LEVEL_BATCH         = 0x09
SMB2_OPLOCK_LEVEL_LEASE         = 0xFF

# SMB2 Impersonation Levels
IMPERSONATION_ANONYMOUS      = 0x00000000
IMPERSONATION_IDENTIFICATION = 0x00000001
IMPERSONATION_IMPERSONATION  = 0x00000002
IMPERSONATION_DELEGATE       = 0x00000003

# Share Access
FILE_SHARE_READ              = 0x00000001
FILE_SHARE_WRITE             = 0x00000002
FILE_SHARE_DELETE            = 0x00000004

# Create Disposition
FILE_SUPERSEDE               = 0x00000000
FILE_OPEN                    = 0x00000001
FILE_CREATE                  = 0x00000002
FILE_OPEN_IF                 = 0x00000003
FILE_OVERWRITE               = 0x00000004
FILE_OVERWRITE_IF            = 0x00000005

# Create Option
FILE_DIRECTORY_FILE            = 0x00000001
FILE_WRITE_THROUGH             = 0x00000002
FILE_SEQUENTIAL_ONLY           = 0x00000004
FILE_NO_INTERMEDIATE_BUFFERING = 0x00000008
FILE_SYNCHRONOUS_IO_ALERT      = 0x00000010
FILE_SYNCHRONOUS_IO_NONALERT   = 0x00000020
FILE_NON_DIRECTORY_FILE        = 0x00000040
FILE_COMPLETE_IF_OPLOCKED      = 0x00000100
FILE_NO_EA_KNOWLEDGE           = 0x00000200
FILE_RANDOM_ACCESS             = 0x00000800
FILE_DELETE_ON_CLOSE           = 0x00001000
FILE_OPEN_BY_FILE_ID           = 0x00002000
FILE_OPEN_FOR_BACKUP_INTENT    = 0x00004000
FILE_NO_COMPRESSION            = 0x00008000
FILE_RESERVE_OPFILTER          = 0x00100000
FILE_OPEN_REPARSE_POINT        = 0x00200000
FILE_OPEN_NO_RECALL            = 0x00400000
FILE_OPEN_FOR_FREE_SPACE_QUERY = 0x00800000

# File Access Mask
FILE_READ_DATA                 = 0x00000001
FILE_LIST_DIRECTORY            = 0x00000001
FILE_WRITE_DATA                = 0x00000002
FILE_ADD_FILE                  = 0x00000002
FILE_APPEND_DATA               = 0x00000004
FILE_ADD_SUBDIRECTORY          = 0x00000004
FILE_READ_EA                   = 0x00000008
FILE_WRITE_EA                  = 0x00000010
FILE_EXECUTE                   = 0x00000020
FILE_TRAVERSE                  = 0x00000020
FILE_DELETE_CHILD              = 0x00000040
FILE_READ_ATTRIBUTES           = 0x00000080
FILE_WRITE_ATTRIBUTES          = 0x00000100
DELETE                         = 0x00010000
READ_CONTROL                   = 0x00020000
WRITE_DAC                      = 0x00040000
WRITE_OWNER                    = 0x00080000
SYNCHRONIZE                    = 0x00100000
ACCESS_SYSTEM_SECURITY         = 0x01000000
MAXIMAL_ACCESS                 = 0x02000000
GENERIC_ALL                    = 0x10000000
GENERIC_EXECUTE                = 0x20000000
GENERIC_WRITE                  = 0x40000000
GENERIC_READ                   = 0x80000000

# SMB2 Lease State
SMB2_LEASE_NONE                = 0x00
SMB2_LEASE_READ_CACHING        = 0x01
SMB2_LEASE_HANDLE_CACHING      = 0x02
SMB2_LEASE_WRITE_CACHING       = 0x04

# Create Action
FILE_SUPERSEDED                = 0x00000000
FILE_OPENED                    = 0x00000001
FILE_CREATED                   = 0x00000002
FILE_OVERWRITTEN               = 0x00000003

# SMB2 Lock Flags
SMB2_LOCKFLAG_SHARED_LOCK      = 0x00000001
SMB2_LOCKFLAG_EXCLUSIVE_LOCK   = 0x00000002
SMB2_LOCKFLAG_UNLOCK           = 0x00000004
SMB2_LOCKFLAG_FAIL_IMMEDIATELY = 0x00000010

# Ctl Codes
FSCTL_DFS_GET_REFERRALS        = 0x00060194
FSCTL_PIPE_PEEK                = 0x0011400C
FSCTL_PIPE_WAIT                = 0x00110018
FSCTL_PIPE_TRANSCEIVE          = 0x0011C017
FSCTL_SRV_COPYCHUNK            = 0x001440F2
FSCTL_SRV_ENUMERATE_SNAPSHOTS  = 0x00144064
FSCTL_SRV_REQUEST_RESUME_KEY   = 0x00140078
FSCTL_SRV_READ_HASH            = 0x001441BB

# SMB2 Ioctl Flags
SMB2_0_IOCTL_IS_FSCTL          = 0x00000001

# File Information Class
FileDirectoryInformation       = 0x01
FileFullDirectoryInformation   = 0x02
FileIdFullDirectoryInformation = 0x26
FileBothDirectoryInformation   = 0x03
FileIdBothDirectoryInformation = 0x25
FileNamesInformation           = 0x0C

# SMB2 Query Flags
SMB2_RESTART_SCANS             = 0x01
SMB2_RETURN_SINGLE_ENTRY       = 0x02
SMB2_INDEX_SPECIFIED           = 0x04
SMB2_REOPEN                    = 0x10

# Completion Filter
FILE_NOTIFY_CHANGE_FILE_NAME    = 0x00000001
FILE_NOTIFY_CHANGE_DIR_NAME     = 0x00000002
FILE_NOTIFY_CHANGE_ATTRIBUTES   = 0x00000004
FILE_NOTIFY_CHANGE_SIZE         = 0x00000008
FILE_NOTIFY_CHANGE_LAST_WRITE   = 0x00000010
FILE_NOTIFY_CHANGE_LAST_ACCESS  = 0x00000020
FILE_NOTIFY_CHANGE_CREATION     = 0x00000040
FILE_NOTIFY_CHANGE_EA           = 0x00000080
FILE_NOTIFY_CHANGE_SECURITY     = 0x00000100
FILE_NOTIFY_CHANGE_STREAM_NAME  = 0x00000200
FILE_NOTIFY_CHANGE_STREAM_SIZE  = 0x00000400
FILE_NOTIFY_CHANGE_STREAM_WRITE = 0x00000800

# File Actions
FILE_ACTION_ADDED               = 0x00000001
FILE_ACTION_REMOVED             = 0x00000002
FILE_ACTION_MODIFIED            = 0x00000003
FILE_ACTION_RENAMED_OLD_NAME    = 0x00000004
FILE_ACTION_RENAMED_NEW_NAME    = 0x00000005

# SMB2 Query Info Type
SMB2_0_INFO_FILE                = 0x01
SMB2_0_INFO_FILESYSTEM          = 0x02
SMB2_0_INFO_SECURITY            = 0x03
SMB2_0_INFO_QUOTA               = 0x04

# Security Info
OWNER_SECURITY_INFORMATION      = 0x00000001
GROUP_SECURITY_INFORMATION      = 0x00000002
DACL_SECURITY_INFORMATION       = 0x00000004
SACL_SECURITY_INFORMATION       = 0x00000008
LABEL_SECURITY_INFORMATION      = 0x00000010

# Query Flags
SL_RESTART_SCAN                 = 0x00000001
SL_RETURN_SINGLE_ENTRY          = 0x00000002
SL_INDEX_SPECIFIED              = 0x00000004

# Dialects
DIALECT_SMB_2002 = 0x0202
DIALECT_SMB_21   = 0x0210
