#get info about all computer objects  from AD
try {
$strCategory = "computer"
$objDomain = New-Object System.DirectoryServices.DirectoryEntry
$objSearcher = New-Object System.DirectoryServices.DirectorySearcher
$objSearcher.SearchRoot = $objDomain
$objSearcher.Filter = ("(objectCategory=$strCategory)")
$objSearcher.SizeLimit = "ARGSIZELIMIT"
$objSearcher.Filter = "(&(objectCategory=computer)(operatingSystem=*))"
$objSearcher.PropertiesToLoad.AddRange(('name','samaccountname','distinguishedname','operatingsystem','description','operatingsystemversion'))

$bleh = @()
Foreach ($ComputerAccount in $objSearcher.FindAll()){
    $bleh +=  ("{0} @##@ {1} @##@ {2}" -f $($ComputerAccount.properties.name), $($ComputerAccount.properties.operatingsystem), $($ComputerAccount.properties.distinguishedname) ) 
}
[String]::Join("***", $bleh) | Out-String

} catch {
  "***" | Out-String
}
