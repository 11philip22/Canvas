$ProgressPreference = 'SilentlyContinue'
$certs = get-childitem -path cert:\localMachine\my
$cert_password = convertto-securestring -string "CERT_PASSWORD" -force -asplaintext
$file_paths = New-Object -TypeName "System.Text.StringBuilder";
write-output "START_OUTPUT"
foreach($cert in $certs){
  $cert_file_name = [System.IO.Path]::GetRandomFileName()
  $cert_file_path = "$env:TEMP\$cert_file_name"
  try {
    export-pfxcertificate -cert $cert -filepath $cert_file_path -password $cert_password | out-null
    $file_paths.Append("$cert_file_path,") | out-null
  } catch {
  }  
}

write-output $file_paths.ToString()
write-output "END_OUTPUT"