<%  
	Sub trigger
		On Error Resume Next
		Err.Clear
		set wshell = Server.CreateObject("WScript.Shell")		
		Set wshSystemEnv = wshell.Environment("SYSTEM")
		processor_arch = wshSystemEnv("PROCESSOR_ARCHITECTURE")
        processor_archw6432 = wshSystemEnv("PROCESSOR_ARCHITEW6432")
		If Err.Number = 0 Then
			If (StrComp(processor_arch, "x86", vbTextCompare) = 0 and (IsNull(processor_archw6432) or processor_archw6432 = "" ))  Then
				filename = "callback_X86.exe"
			Else
				filename = "callback_X64.exe"
			End If
		Else
			Err.Clear
			filename = "callback_X86.exe"
		End If
		'curr_path = Server.MapPath(".")
		'mosdef_path = curr_path & "\" & filename
		mosdef_path = Server.MapPath(filename)
		'Response.Write "About to execute: " & mosdef_path
		wshell.Run mosdef_path, 0
		set wshell = nothing 
		If Err.Number <> 0 Then
			Response.Write "An error ocurred while running callback - Number: " & Error.Number & " - Description: " & Err.Description & "<br><p>"
			'Exit Sub
		Else
			Response.Write "MOSDEF Callback successfully triggered"
		End If
    End Sub
	
	trigger
%>
